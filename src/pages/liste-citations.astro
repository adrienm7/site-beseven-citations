---
import Base from "../layouts/Base.astro";
---

<Base>
	<div>
		<nav class="navbar sticky-top navbar-light bg-primary">
			<div class="btn-group mx-auto">
				<button class="btn btn-light bordure-bouton">
					<a href="https://citations.beseven.fr" class="lien_site"
						><span class="d-none d-lg-inline">Citation </span>Aléatoire</a
					>
				</button>
				<div class="btn-group">
					<button
						class="btn btn-light dropdown-toggle bordure-bouton"
						type="button"
						id="categorie_selectionnee"
						data-toggle="dropdown"
						aria-haspopup="true"
						aria-expanded="false"
					>
						<i class="far fa-globe"></i> Toutes
					</button>
					<div class="dropdown-menu dropdown-menu-center">
						<button id="Toutes" class="dropdown-item" type="button">
							<i class="far fa-globe"></i> Toutes les citations
						</button>
						<div class="dropdown-divider"></div>
						<button id="Inspirant" class="dropdown-item" type="button">
							<i class="far fa-compass"></i> Citations inspirantes
						</button>
						<button id="Action" class="dropdown-item" type="button">
							<i class="fad fa-transporter-1"></i> Citations sur l’action et la persévérance
						</button>
						<button id="Réflexion" class="dropdown-item" type="button">
							<i class="far fa-lightbulb"></i> Citations sur la réflexion
						</button>
						<button id="Apprentissage" class="dropdown-item" type="button">
							<i class="fad fa-graduation-cap"></i> Citations sur l'apprentissage
						</button>
						<button id="Relations" class="dropdown-item" type="button">
							<i class="fad fa-users"></i> Citations sur les relations
						</button>
						<button id="Bonheur" class="dropdown-item" type="button">
							<i class="far fa-smile"></i> Citations sur le bonheur
						</button>
						<div class="dropdown-divider"></div>
						<button id="Autres" class="dropdown-item" type="button">
							<i class="fad fa-alicorn"></i> Citations diverses
						</button>
						<button id="Humour" class="dropdown-item" type="button">
							<i class="far fa-laugh-squint"></i> Citations humoristiques
						</button>
						<button id="Geek" class="dropdown-item" type="button">
							<i class="fas fa-laptop-code"></i> Citations geek, cinéphiles et otaku
						</button>
						<div class="dropdown-divider"></div>
						<button id="BeSeven" class="dropdown-item" type="button">
							<i class="far fa-universal-access"></i> Citations des membres de BeSeven
						</button>
					</div>
				</div>
				<button id="bouton_b7" class="btn btn-light bordure-bouton">
					<a href="https://www.beseven.fr" class="lien_site"
						><span class="d-none d-lg-inline">Site de </span>BeSeven</a
					>
				</button>
			</div>
		</nav>
		<main>
			<h1 id="titre">Toutes les citations</h1>
			<hr />
			<petit-espace></petit-espace>
			<a href="https://citations.beseven.fr"
				><button class="btn btn-outline-primary">
					Revenir à l'afficheur aléatoire
				</button></a
			>
			<!-- <a href="/documents/liste-citations.pdf"><button class="btn btn-default">Télécharger au format PDF</button></a> -->

			<div id="contenu">
				<h2 id="titre-Inspirant" data-nom="Inspirant">Inspirant</h2>
				<div id="citations-Inspirant"></div>

				<h2 id="titre-Action" data-nom="Action">Action</h2>
				<div id="citations-Action"></div>

				<h2 id="titre-Réflexion" data-nom="Réflexion">Réflexion</h2>
				<div id="citations-Réflexion"></div>

				<h2 id="titre-Apprentissage" data-nom="Apprentissage">Apprentissage</h2>
				<div id="citations-Apprentissage"></div>

				<h2 id="titre-Relations" data-nom="Relations">Relations</h2>
				<div id="citations-Relations"></div>

				<h2 id="titre-Bonheur" data-nom="Bonheur">Bonheur</h2>
				<div id="citations-Bonheur"></div>

				<h2 id="titre-Autres" data-nom="Autres">Autres</h2>
				<div id="citations-Autres"></div>

				<h2 id="titre-Humour" data-nom="Humour">Humour</h2>
				<div id="citations-Humour"></div>

				<h2 id="titre-Geek" data-nom="Geek">Geek</h2>
				<div id="citations-Geek"></div>

				<h2 id="titre-BeSeven" data-nom="BeSeven">BeSeven</h2>
				<div id="citations-BeSeven"></div>
			</div>
		</main>

		<footer>
			<p class="texte_footer">
				Copyright ©
				<strong><a href="https://www.beseven.fr" class="text-white">BeSeven</a></strong>. <span
					>Tous&nbsp;droits&nbsp;réservés.</span
				>
			</p>
		</footer>
	</div>
</Base>
<link rel="stylesheet" href="/css/style_liste_citations.css" />
<script src="/js/noframework.waypoints.min.js" is:inline></script>
<script>
	// Sélection de l'élément parent où insérer les catégories et citations
	const container = document.getElementById("contenu");

	// Liste des catégories à afficher
	const categories = [
		"Inspirant",
		"Action",
		"Réflexion",
		"Apprentissage",
		"Relations",
		"Bonheur",
		"Autres",
		"Humour",
		"Geek",
		"BeSeven",
	];

	// Fonction pour charger et afficher les citations par catégorie
	function afficheCitations() {
		fetch("/citations.json")
			.then((response) => {
				if (!response.ok) {
					throw new Error("Erreur lors du chargement du fichier JSON");
				}
				return response.json();
			})
			.then((data) => {
				categories.forEach((categorie) => {
					// Récupérer les éléments statiques déjà présents
					const titre = document.getElementById(`titre-${categorie}`);
					const citationsContainer = document.getElementById(`citations-${categorie}`);

					// Filtrer les citations de la catégorie actuelle
					const citationsFiltrees = data.filter((item) => item.categorie === categorie);

					// Générer les blocs de citations
					citationsFiltrees.forEach((item) => {
						const blockquote = document.createElement("blockquote");
						blockquote.innerHTML = `
								${item.citation}<br />
								${item.auteur ? `<cite>— ${item.auteur}</cite>` : ""}
							`;
						citationsContainer.appendChild(blockquote);
					});
				});

				// Rafraîchir Waypoints après ajout des citations
				Waypoint.refreshAll();
			})
			.catch((error) => console.error("Erreur :", error));
	}

	// Initialiser les Waypoints pour chaque titre
	function initWaypoints() {
		categories.forEach((categorie, index) => {
			const element = document.getElementById(`titre-${categorie}`);
			const previousCategorie = index === 0 ? "Toutes" : categories[index - 1];

			new Waypoint({
				element: element,
				handler: function (direction) {
					if (direction === "up") {
						change(previousCategorie);
					} else {
						change(categorie);
					}
				},
			});
		});
	}

	// Charger les citations et initialiser les Waypoints
	afficheCitations();
	initWaypoints();
</script>
