---
import Base from "../layouts/Base.astro";

// Importation des citations depuis un fichier JSON statique
import citations from "../data/citations.json";

// Catégories disponibles
const categories = [
	"Inspirant",
	"Action",
	"Réflexion",
	"Apprentissage",
	"Relations",
	"Bonheur",
	"Autres",
	"Humour",
	"Geek",
	"BeSeven",
];

// Organiser les citations par catégorie
const citationsByCategory = categories.reduce((acc, category) => {
	acc[category] = citations.filter((citation) => citation.categorie === category);
	return acc;
}, {});
---

<Base>
	<div>
		<nav class="navbar sticky-top navbar-light bg-primary">
			<div class="btn-group mx-auto">
				<button class="btn btn-light bordure-bouton">
					<a href="https://citations.beseven.fr" class="lien_site"
						><span class="d-none d-lg-inline">Citation </span>Aléatoire</a
					>
				</button>
				<div class="btn-group">
					<button
						class="btn btn-light dropdown-toggle bordure-bouton"
						type="button"
						id="categorie_selectionnee"
						data-toggle="dropdown"
						aria-haspopup="true"
						aria-expanded="false"
					>
						<i class="far fa-globe"></i> Toutes
					</button>
					<div class="dropdown-menu dropdown-menu-center">
						<button id="Toutes" class="dropdown-item" type="button">
							<i class="far fa-globe"></i> Toutes les citations
						</button>
						<div class="dropdown-divider"></div>
						<button id="Inspirant" class="dropdown-item" type="button">
							<i class="far fa-compass"></i> Citations inspirantes
						</button>
						<button id="Action" class="dropdown-item" type="button">
							<i class="fad fa-transporter-1"></i> Citations sur l’action et la persévérance
						</button>
						<button id="Réflexion" class="dropdown-item" type="button">
							<i class="far fa-lightbulb"></i> Citations sur la réflexion
						</button>
						<button id="Apprentissage" class="dropdown-item" type="button">
							<i class="fad fa-graduation-cap"></i> Citations sur l'apprentissage
						</button>
						<button id="Relations" class="dropdown-item" type="button">
							<i class="fad fa-users"></i> Citations sur les relations
						</button>
						<button id="Bonheur" class="dropdown-item" type="button">
							<i class="far fa-smile"></i> Citations sur le bonheur
						</button>
						<div class="dropdown-divider"></div>
						<button id="Autres" class="dropdown-item" type="button">
							<i class="fad fa-alicorn"></i> Citations diverses
						</button>
						<button id="Humour" class="dropdown-item" type="button">
							<i class="far fa-laugh-squint"></i> Citations humoristiques
						</button>
						<button id="Geek" class="dropdown-item" type="button">
							<i class="fas fa-laptop-code"></i> Citations geek, cinéphiles et otaku
						</button>
						<div class="dropdown-divider"></div>
						<button id="BeSeven" class="dropdown-item" type="button">
							<i class="far fa-universal-access"></i> Citations des membres de BeSeven
						</button>
					</div>
				</div>
				<button id="bouton_b7" class="btn btn-light bordure-bouton">
					<a href="https://www.beseven.fr" class="lien_site"
						><span class="d-none d-lg-inline">Site de </span>BeSeven</a
					>
				</button>
			</div>
		</nav>
		<main>
			<h1 id="titre">Toutes les citations</h1>
			<hr />
			<petit-espace></petit-espace>
			<a href="https://citations.beseven.fr"
				><button class="btn btn-outline-primary">
					Revenir à l'afficheur aléatoire
				</button></a
			>
			<!-- <a href="/documents/liste-citations.pdf"><button class="btn btn-default">Télécharger au format PDF</button></a> -->

			<div id="contenu">
				{
					categories.map((categorie) => {
						const citationsForCategory = citationsByCategory[categorie];
						return (
							<>
								<h2 id={`titre-${categorie}`} data-nom={categorie}>
									{categorie}
								</h2>
								<div id={`citations-${categorie}`}>
									{citationsForCategory.map((citation) => (
										<blockquote>
											{citation.citation}
											<br />
											{citation.auteur && <cite>— {citation.auteur}</cite>}
										</blockquote>
									))}
								</div>
							</>
						);
					})
				}
			</div>
		</main>

		<footer>
			<p class="texte_footer">
				Copyright ©
				<strong><a href="https://www.beseven.fr" class="text-white">BeSeven</a></strong>. <span
					>Tous&nbsp;droits&nbsp;réservés.</span
				>
			</p>
		</footer>
	</div>
</Base>
<link rel="stylesheet" href="/css/style_liste_citations.css" />
<script src="/js/noframework.waypoints.min.js" is:inline></script>
<script>
	// Initialiser Waypoints après que les citations aient été rendues
	document.addEventListener("DOMContentLoaded", () => {
		// Fonction pour initialiser les Waypoints
		function initWaypoints() {
			const categories = [
				"Inspirant",
				"Action",
				"Réflexion",
				"Apprentissage",
				"Relations",
				"Bonheur",
				"Autres",
				"Humour",
				"Geek",
				"BeSeven",
			];

			categories.forEach((categorie, index) => {
				const element = document.getElementById(`titre-${categorie}`);
				const previousCategorie = index === 0 ? "Toutes" : categories[index - 1];

				new Waypoint({
					element: element,
					handler: function (direction) {
						if (direction === "up") {
							change(previousCategorie);
						} else {
							change(categorie);
						}
					},
				});
			});
		}

		// Initialiser Waypoints
		initWaypoints();

		// Rafraîchir les Waypoints après ajout des citations
		Waypoint.refreshAll();
	});
</script>
